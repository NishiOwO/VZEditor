----------------------------------------------------------------------
        mkmodule.com が生成するモジュールでは満足できない人の為に．．．

        30bios.comに取り込まれるモジュールの規約を以下に述べます。
        この規約にもとづいて自分で作成したモジュールは30bios.comの
        -@オプションなどによって、使用することが可能となります。

        またこれらのモジュールは、mkmodule.com を使用すると、[SHIFT]+[f･10]
        によって module00.inc などが生成されるので、これを元に手直し
        し、サンプルの module.asm をアセンブルすることで、より簡単に
        作成できるようにしてあります。
        腕に自身のある方は是非お試しください。

----------------------------------------------------------------------
        << パラメータ計算モジュールのフォーマットと作り方 >>

        モジュールファイルは、基本的にCOMモデルです。

offset 0000h〜 StartUp部(30bytes)
        001Dh   ユーザーが誤ってこのモジュールを実行しても大丈夫なよ
                うにプロセス終了ルーチンを入れておきます。
                サンプルとして付属した module.asm では、COPYRIGHTの
                表示と、30bios.comが対応していないサイズのモジュール
                の場合にBEEP音を鳴らすようにしてみました。

offset 001Eh〜 モジュールサイズ(2bytes)
        001Fh   モジュール本体部分の大きさのバイト数を格納しておきま
                す。現在はモジュール本体のサイズが64byte以下である必
                要があるためここの値もそうなるべきでしょう。

offset 0020h〜 モジュール本体部分(64bytes)
        005Fh   このモジュールが呼び出されるときに、

                AL      ; 設定行数
                VS      ; 垂直同期信号の幅   (default =     8, byte値)
                HS      ; 水平同期信号の幅   (default =     8, byte値)
                HFP     ; CRT右側の非表示区間(default =    10, byte値)
                HBP     ; CRT左側の非表示区間(default =     8, byte値)
                VFP     ; CRT下側の非表示区間(default =     7, byte値)
                VBP     ; CRT上側の非表示区間(default =    25, byte値)

                LF      ; 1画面のライン数    (default = AL*16, word値)
                VS_HS   ; 上記のVS,HSのペア  (VS上位 /HS下位 , word値)
                HFP_HBP ; 上記のHFP,HBPのペア(HFP上位/HBP下位, word値)
                VFP_VBP ; 上記のVFP,VBPのペア(VFP上位/VBP下位, word値)

                以上のSYMBOLが定義されているので、これらを元にALレジ
                スタの値(設定行数)から、VS,HS,HFP,HBP,VFP,VBPを算出す
                るプログラムを用意します。

                注:このモジュールが使用される時のロードoffsetが一定では
                   ない為、完全リラティブな書き方をしなければいけま
                   せん。(^^;
                   モジュール内のoffsetを得る為には
                   > call $+3
                   > pop  di
                   などの工夫が必要です。

                注:BX,CX,DX,BPは使用出来ません。AX,SI,DIは破壊可です。

                注:HS,HFP,HBPはそれぞれ2以上の偶数でないとGDC2.5MHz
                   時にグラフィックが乱れてしまいます。

                注:それぞれの最小値、最大値は以下の通りです。
                   VS      = 1〜31
                   HS      = 2〜32(ただしGDC 2.5MHz時は偶数のみ)
                   VFP,VBP = 1〜63
                   HFP,HBP = 2〜64(ただしGDC 2.5MHz時は偶数のみ)
                   * HS,HFP,HBPはGDCに設定する値より1大きい値を与えて
                   　ください。mkmodule.comが表示している値はGDCに設
                   　定している値です。


offset 0060h〜 Copyrightメッセージ他(free)
                特に用途はありません。StartUp部とのかねあいで決めれば
                良いでしょう。

                注:30bios.com ver 0.10 以降では、'30行BIOS'という文字
                   列が何処かに無いと(StartUp部でも良い)、CRT モジュールだ
                   と認めません。入れ忘れても、BINARYエディタで最後に
                   付け加えれば良いだけですが。(笑)

----------------------------------------------------------------------
