
                30行BIOS用定義ファイル「30BIOS.INI」ドキュメント

                                                written by walker

1. はじめに
        30行BIOSは、バージョンアップの度に機能強化を図ってきました。
        しかし、機能が増えるとオプションが多様になり、コマンドライン
        からの指定も面倒になってきます。
        そこで、30行BIOSのオプション等の定義ファイルを作成し、それを
        参照することで、コマンドライン入力の手間を省く目的で作られた
        のが、30BIOS.INIです。
        また、従来はCRTモジュールを変更しなければならなかったGDCパラ
        メータも、定義ファイルにデータを書き込むことで、CRTモジュー
        ルを作り直す必要がなくなりました。ちょっとしたパラメータの変
        更を試したいだけならば、30BIOS.INIを編集するだけで十分でしょ
        う。


2. 記述の方法
        まず、自分のパソコンが31kHzのハイリフレッシュレートを使えるか
        どうか確認して下さい。98MATEならば31kHzが利用できます。
        ・31kHzが使える機種用　→　30BIOS31.INI
		・31kHzが使えない機種用→　30BIOS24.INI
        このように2つのINIファイルを用意しておきましたので、該当する
        ファイルを「30BIOS.INI」にリネームして、30BIOS.COMと同じディ
        レクトリにおいてください。
        とりあえずこれだけで利用可能です。

        文法は、基本的にWindowsのINIファイルと同じにしてあります。
        30BIOS.INIのサイズは、30BIOS.COMのバージョンによって異なりま
        すが、30BIOS.COMと30BIOS.INIを合わせて60Kバイトが限界です。
        やたらにコメントを多く入れ、60Kバイトを超えてしまうと、正常
        に解析できませんので注意してください。
        また、セクション名とキー名は、大文字/小文字のどちらでも構い
        ません。

        ;INI FILE for 30行BIOS ------(1)
        [セクション名] --------------(2)
        キー名 = <値> -+
        キー名 = <値> -+-------------(3)
        キー名 = <値> -+
        　　:
        　　:

        (1)コメント行
        　「;」(セミコロン)から行末までは、コメントとして無視されま
        　す。ただし、1行目はINIヘッダなのでコメント行として扱われま
        　す。セクション名等を書いても解析時に無視されます。

        (2)セクション名
        　必ず行頭になければなりません。半角の「[]」で囲まれた文字列
        　がセクション名として解釈されます。30行BIOSで利用されるセク
        　ションは、以下の2つです。

        　[TSR_DRIVER]、[30BIOS]

        (3)キー名 = <値>
        　キー名では、30行BIOSを制御する細かいオプションを指定します。
        　30BIOS.COMは、知らないキー名があった場合、その行全体を無視
        　します。
        　キー名の細かい意味は後で述べます。
        　「=」の右側が、キー名に対する値になります。

        　同じキー名、または同じはたらきをするキー名が複数あった場合
        　は、一番最後に指定された値が優先されます。
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


3. セクション名とキー名の機能

3.1. [TSR_DRIVER]セクション
        30行BIOSの常駐プロセス等の制御を行います。利用可能なキー名は
        以下のとおりです。

        ・Message = <Color/Mono>
        　30行BIOSの表示メッセージをエスケープシーケンスを用いたカラ
        　ーにするか、モノクロにするかを指定します。-$オプションと同
        　じです。

        ・Use_Umb = <Yes/No>
        　UMBに常駐するかどうかを指定します。-#オプションと同じです。

3.2. [30BIOS]セクション
        30行BIOSの画面制御を指定します。利用可能なキー名は以下のとお
        りです。

        ・Option = <値>
        　30BIOS.COMのコマンドラインオプションを指定します。常に指定
        　しておきたいオプションは、ここに記述しておくとよいでしょう。

        　(例)
        　Option = v
        　Option = a2036
        　Option = p
        　上のように一つ一つ指定しても構いませんし、コマンドライン指
        　定同様、
        　Option = va2036p
        　のように続けて指定しても構いません。

        ・Ctrl_F10_Patch = <Yes/No>
        　[CTRL]+[f･10]キーで「標準モード←→拡張モード」を可能にす
        　るためのパッチをメモリ上のIO.SYSに当てる指定です。-pオプ
        　ション指定と同意です。
        　(例)Ctrl_F10_Patch = Yes      ;-p

        ・Min_Line = <値>
        　変更可能な最小行数を指定します。-aオプションにおける最小行
        　数の指定と同じです。
        　(例)Min_Line = 20             ;-a<値>mm

        ・Max_Line = <値>
        　変更可能な最大行数を指定します。-aオプションにおける最大行
        　数の指定と同じです。
        　(例)Max_Line = 40             ;-ann<値>

        ・Default_Line = <値>
        　拡張モード時における行間なし表示行数を指定します。-lオプシ
        　ョンと同じです。
        　(例)Default_Line = 30         ;-l<値>

        ・Char_Height = <値>
        　行間空きモード時における、一行あたりのドット数(ラスタ数/文字)
        　を指定します。デフォルトは20です。-hオプションと同じです。
        　(例)Char_Height = 18          ;-h<値>

        ・Screen_Mode = <Function/Cw>
        ・Screen_Mode = <Normal/Vga/Special>
        　このキー名は2つ指定可能です。一つは、ファンクションキー表
        　示の扱いについて、もう一つは画面モードについてです。前者は
        　-c,-fオプションと同じ、後者は-n,-v,-sオプションと同じです。
        　(例)Screen_Mode = Function    ;-f, -c
        　　　Screen_Mode = Vga         ;-n, -v, -s

        ・Module_Bin = <ファイル名>
        　組み込むCRTモジュールのファイル名を指定します。ファイル名
        　のみの指定ときは、30行BIOSと同じディレクトリを探します。別
        　のディレクトリにあるCRTモジュールを扱うためにはフルパスで
        　指定してください。-@オプションと同じです。
        　(例)Module_Bin = A:\MODULE\XC1498.COM         ;-@<file名>

        ・Module_Zone = {{パラメータ},{パラメータ},…}
        　GDCに送るパラメータを指定します。MKMODULE.COMで自動生成し
        　たCRTモジュールを実行すると、VS、HS等のパラメータを画面(標
        　準出力)に出力されます。これをリダイレクトで取り込めば、
        　30BIOS.INIでGDCパラメータの指定が可能になります。既存の
        　CRTモジュールを利用して、一時的にGDCパラメータを変更すると
        　きに利用するとよいでしょう。パラメータは、"{","}"で囲まれ
        　たゾーンで分けて表記します。各ゾーンのパラメータは、一番右
        　の値である"行数"に示される範囲においてのみ有効です。つまり、
        　「26行から34行まではこのパラメータ、35行以上は他のパラメー
        　タ、…」というように行数に応じてGDCに送るパラメータを変更
        　することができるわけです。これらのパラメータは、30行BIOSの
        　常駐ルーチンに保存され、行数変更の際に読みだされて、その都
        　度GDCに送られます。常駐量の肥大化を防ぐため、指定できるゾ
        　ーンは5つまでです。
        　(例)Module_Zone = {
                ;{ VS  HS  HFP HBP VFP VBP  行数  }コメント行
        　       { 20, 13, 15, 15, 01, 01, 26〜34 },
                 { 31, 20, 07, 07, 01, 01, 35〜   },
                } 


4. リフレッシュレートに応じたパラメータの変更
        98MATEやH98のハイリフレッシュレート(水平走査周波数31kHz)では、
        表示行数を増やしても、ノーマル98の24kHzよりチラツキが少ない
        ので、快適なテキスト環境が期待できます。
        98MATEでは、[GRPH]キーと[2]を押しながらリセットすることで、
        31kHzのハイリフレッシュレートで起動します。98MATEならば、31kHz
        を使った方が、より多くの行数で表示することができます。

        30行BIOSでは、24kHzと31kHzにおけるGDCパラメータを別々に設定
        することが可能です。
        [30BIOS]セクションのうち次のキー名は、接尾語を許可します。

        Min_Line, Max_Line, Default_Line, Char_Height, Screen_Mode,
        Module_Bin, Module_Zone

        接尾語は、「24」「31」の2つです。すなわち、

        Max_Line24 = 32                 ; 24kHz Mode時
        Max_Line31 = 44                 ; 31kHz Mode時

        といった指定が可能です。

        30行BIOSは、現在のリフレッシュレートをBIOSワークエリアから取
        得し、その値を接尾語として扱います。そのため、24kHzと31kHzの
        変更が可能な98MATEでは、あらかじめ最適なパラメータをセットし
        ておくことで、INIファイルを変更することなく、自動的にそれぞ
        れのリフレッシュレートに合わせたパラメータをセットさせること
        ができます。

[END OF 30B_INI.DOC]
