# 第９章 各機種板について

## ９.１ マルチ機種対応

&emsp;VZのマスターディスクには、以下の各機種版の「VZ???.COM」が入っており、インストール時に動作マシンを判定し、対応するコマンドをコピーします。

**【98フォーマット・ディスク】**<br>
&emsp;　　　・PC-9801版　　　　 VZ.COM	<br>
&emsp;　　　・J-3100 版　　　　　¥J31¥VZJ31.COM<br>

**【IBMフォーマット・ディスク】**<br>
&emsp;　　　・DOS／V版　　　　 VZIBM.COM, VZIBMJ.COM<br>
&emsp;　　　・AX版　　　　　　　¥AX¥VZAX.COM<br>
&emsp;　　　・PS／55版　　　　　¥PS55¥VZ55.COM<br>
&emsp;　　　・英語モード専用版　¥US¥VZUS.COM<br>


&emsp;この章では、PC-9801版とDOS／V版について、それぞれの特長的な機能を説明します。それ以外の機種については、各機種版のオンライン・ドキュメントをご覧ください。



## ９.２ PC-9801版

&emsp;PC-9801版には、次のような特長があります。

- スムーススクロール機能
- バックスラッシュの表示機能
- 新JIS罫線文字の表示機能
- [**CTRL**]+テンキーによる全角記号入力機能
- 26行以上のテキスト画面に対応

### ■ スムーススクロール機能
&emsp;ドット単位でテキスト画面をなめらかにスクロールする機能です。ハイレゾモードではドット単位のスクロールはできません。
### ■ バックスラッシュの表示機能
&emsp;半角の「¥」を「＼」で表示します。VZ動作中のDOSの出力も「＼」で表示します。オプション**Db**で設定します。

	Db-		￥文字の表示
### ■ 新JIS罫線文字の表示機能
&emsp;NECのPC-98シリーズは、漢字コードがJIS78（旧JIS）であるため、新JISの罫線文字が表示できません。オプション**Dg**を「**+**」にすると、新JIS罫線文字を98罫線文字に変換して表示します。

	Dg+		新JIS罫線の表示

&emsp;EPSONの98互換機は新JISフォントを表示できますので、このオプションは必要ありません。
### ■ [**CTRL**]+[テンキー]による全角記号入力機能
&emsp;[**CTRL**]+[テンキー]または[**GRPH**]+[テンキー]で、全角文字を入力できます。「4.8 その他のコマンド」をご覧ください。
### ■ 26行以上のテキスト画面に対応
&emsp;本製品にも含まれる「30BIOS.COM」などを使った、26行以上のテキスト画面に対応しています。「30BIOS.COM」の場合は、最大の行数を自動的に取得しますので、特に設定は必要ありません。その他のソフトをお使いの場合は、オプション**LC**で最大行数を指定してください。この場合、「行間空きモード」で起動することはできません。


&emsp;次に、98版に関する主な特記事項をあげます。
### ■ 行間空きモード
&emsp;オプション**LC**の意味が代わりました。編集時の行数ではなく、「行間空けモード」
を指定します。

	LC-		編集時の行間空きモードの指定
	 	-	DOSの画面モードのまま
	 	+	編集画面で行間空けモードを切り替える
	 	20	編集画面で行間空けモードにする
	 	25	編集画面で行間詰めモードにする
### ■ [**CTRL**]+[f･n]キー
&emsp;編集モードでは、DOSの[**CTRL**]+[**f･n**]キーの機能をマスクしています。オプション**FK**を「**+**」にすれば、[**CTRL**]+[**f･n**]キー、および[**vf･1**]～[**vf･5**]のキーをVZで利用できます。
### ■ 裏グラフィックVRAMの利用
&emsp;Ver1.6では、裏グラフィックVRAMをワークに利用するオプション**GV**は、廃止しました。<br>　NEC版「EMM386.SYS」には、ノーマルモード時に、グラフィックVRAMの「B0000h」にEMSのページフレームを割り当てる機能があります。従来版ではこれに対応していましたが、Ver1.6は対応しません。
### ■ FEPの自動制御
&emsp;ATOK6／7／8，VJEβ、松茸、WXII、MS漢字API対応のFEPを自動制御できます。



## ９.３ DOS／V版

&emsp;DOS／V版には、次のような特長があります。

- 日本語、英語両モード対応
- V-Text対応
- シャドウ付きポップアップ・ウインドウ
- 日本語モード時のカーソルのブリンク、全角表示機能
- アナログパレット機能
- [**Ctrl**]、[**Alt**]のキーコンビネーションの拡張
### ■ 日本語、英語両モード対応
&emsp;DOS／V版VZは、日本語、英語、両モードで動作します。常駐したままでの「CHEV」コマンドによるモードの切り替えも可能です。ただし。「VZIBMJ.COM」は、メッセージが日本語になっていますので、英語モードではメッセージが読めません。両モードで使う場合は、「VZIBM.COM」をお使いください。
### ■ V-Text対応
&emsp;V-Textに対応しています。<br>　・横文字数は80～255、縦行数は25～50。<br>　・縦行数が50を越える場合は、オプション**LC**に最大行数を設定してください。<br>　編集モードでV-Textモードにしたい場合は、オプション**VM**にV-Textのビデオモードを設定してください。**VM0**の場合は、画面モードは切り替えません。

	VM$70		編集時のスクリーンモード
### ■ シャドウ付きポップアップ・ウインドウ
&emsp;ポップアップ･ウインドウを立体的に美しく見せるために、影をつけました。
### ■ 日本語モード時のカーソルのブリンク、全角表示機能
&emsp;DOS／Vにはカーソルのこれらの表示機能はありませんので、VZ側で対応しました。全角表示は、文字カラーの反転で実現しているため、ブロックカーソル以外は対応できません。
### ■ アナログパレット機能
&emsp;テキストカラー16色を、64色のアナログパレットから選べます。標準設定では、バックグラウンドを暗い青に、FEPのガイドラインで使われる茶色を黄色に設定しています。パレットの初期値は、DEFファイルに記述してあります。

* E その他
12	"$(00,08,02,0B,04,05,06,07,38,09,3A,3B,3C,3D,3E,3F)"

この部分をコメントとすれば、パレットは変更されません。<br>　「PALET.DEF」を使うと、画面上でパレットを変更できます。[**Shift**]+[**F11**]の「外部マクロメニュー」で呼び出してください。<br>　DEFファイルの上記の箇所にカーソルを置いた状態でマクロを実行し、[**Ins**]を押すと、パレットの設定をテキストに挿入します。
### ■ Ctrl]、[**Alt**]のキーコンビネーションの拡張
&emsp;DOS／V版では、次の4つを除く全ての[**Ctrl**]+[**特殊キー**]、[**Alt**]+[**特殊キー**]の入力が可能です。

&emsp;　　　[**Ctrl**]+[**Esc**]　 [**Alt**]+[**¥**]　 [**Alt**]+[**^**]　 [**Alt**]+[**_**]<br>

これを利用して、カット＆ペースコマンドを次のキーで操作できます。
|キー|機能|
|---|---|
|[**Alt**]+[**Del**]|行･ブロック削除|
|[**Alt**]+[**Ins**]|行･ブロック挿入|
|[**Shift**]+[**Alt**]+[**Del**]|行･ブロック記憶|
|[**Shift**]+[**Alt**]+[**Ins**]|行･ブロック複写|

&emsp;次のキーは、印字されたキーとは異なるキーで入力します。

&emsp;　　　[**Ctrl**]+[@]  →	[**Ctrl**]+[**2**]<br>
&emsp;　　　[**Ctrl**]+[^]  →	[**Ctrl**]+[**6**]<br>
&emsp;　　　[**Ctrl**]+[_]  →	[**Ctrl**]+[-]<br>



&emsp;次に、DOS／V版に関する主な特記事項をあげます。
### ■ スクロール時の画面上下のぶれ
&emsp;DOS／Vの標準「$DISP.SYS」では、スクロールの際にハードウェアスクロール（画面の表示アドレスを変える）を行なうため、スクロールしない画面の上下がぶれてしまいます。この時、オプション**Dg**+を設定すると、多少ぶれが軽減される場合があります。この機能は、横80文字のハードスクロール（上方向）時のみ有効です。

	Dg+		最上行の"ぶれ"の軽減

&emsp;市販のWindowsアクセラレータ対応のディスプレイドライバを使用すれば、この現象は起きません。
### ■ 画面の行数
&emsp;日本語モードでは、画面最下行を常にFEPガイド行としてリザーブしているため、編集画面は98版より1行少なくなっています。オプション**LC**を0とすると、最下行にファンクションキーを表示し、編集画面が1行増えます。ただしこの時FEPをオンすると、FEPのガイドラインがファンクションキーと重なって表示されます。通常は**LC**+のままでお使い下さい。

	LC+		;日本語モード時の最下行の予約
### ■ 画面の行数
&emsp;「ANSI.SYS」は、必ず組み込んでください。さもないと、非常駐モードでVZから子プロセスを実行した時、DOSの文字が黄色になってしまいます。
### ■ FEPの自動制御
&emsp;＄IAS、およびMS漢字API対応のFEPを自動制御できます。



