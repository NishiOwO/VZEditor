==============================================================================
	VZ Editor Version 1.60  Copyright (C) 1989-93 by c.mos
				VZ16.DOC
==============================================================================

　このドキュメントでは、Ｖｅｒ１.６の機能の強化、変更点について、マニュアルの補足説明をします。マクロの関連事項、オプションのリファレンスは、MAC16.DOCをご覧ください。

			　	　目　次
		-----------------------------------------
			１．ＤＥＦファイル関連
			２．メモリ管理
			３．ファイルの操作
			４．スクリーンエディット
			５．ファイラー
			６．ＤＯＳコマンドライン
			７．カスタマイズ
			８．その他の改良事項
		-----------------------------------------




		-----------------------------------------
			１．ＤＥＦファイル関連
		-----------------------------------------

		・ブロックＩＦ文
		・９８版とＩＢＭの両用キー定義
		・インクルードDEFファイルが存在しない場合
		・「vz -w」の廃止


■ ブロックＩＦ文
-----------------------------
　複数の機種で共通のＤＥＦファイルを使えるように、機種毎のＩＤをチェックするブロックＩＦ文が使えます。「７．３ ブロックＩＦ文」をお読みください。
　また、「#if 0」のように未定義のＩＤ文字列を指定すれば、その間にコメントを記述することもできます。


■ ９８版とＩＢＭの両用キー定義
-----------------------------
　次の４つのキーは、９８版とＩＢＭ系機種版で共通に使えます。

９８版：	[RLUP] [RLDN] [CLR] [HELP]
ＩＢＭ版：	[PGDN] [PGUP] [HOME] [END]


■ インクルードDEFファイルが存在しない場合
-----------------------------
　VZ.DEFの「* E その他 1」で指定したＤＥＦファイル、またはコマンドラインで「+file」で指定したＤＥＦファイルが見つからなかった場合に、

	"..."が見つかりません.（CTRL-Cで中止）

と聞いてきます。そのまま起動したい場合は、任意のキーを押してください。
ただし、「/file」で指定した最初に読み込むべきＤＥＦファイルを無視すると、小さな窓を表示していっさいのキーを受け付けなくなりますので、ご注意ください。


■ 「vz -w」の廃止
-----------------------------
　セグメント配置の変更により、カスタマイズ後のデータを６４ＫＢのＣＯＭモデルにセーブすることができません。このため、「-w」オプションは廃止しました。「w,ww」は、汎用変数として使えます。




		-----------------------------------------
			２．メモリ管理
		-----------------------------------------

		・ＣＳとＤＳの分離
		・オプション「Bq」の廃止。
		・テンポラリ管理
		・ＥＭＳ／ＸＭＳの解放


■ ＣＳとＤＳの分離
-----------------------------
　動作時のコードセグメントとデータセグメントを分離し、各種ワークエリアが合計６４ＫＢまで確保可能になりました。
　ただし、次のワークエリアは、コードセグメント内に存在します。

	bseg	「-SW3」常駐時のコードエリア
	hseg	機種依存部（scrn??.asm,key??.asm）内のローカルワーク


■ オプション「Bq」の廃止。
-----------------------------
　テンポラリファイルをメインメモリまたはＥＭＳ，ＸＭＳ上に確保するオプション「Bq」は廃止しました。テンポラリファイルおよびスワップファイルは、まずＸＭＳがある限り使用し、次にＥＭＳを使用します。テンポラリファイルをメインメモリに確保することはできません。


■ テンポラリ管理
-----------------------------
　ＥＭＳ、ＸＭＳ、テンポラリファイルを、合計１６ＭＢまで管理できます。詳しくは、「３．２ マルチファイル」をお読みください。

★注意★
　１６ＭＢというのはあくまで管理の上限です。テンポラリファイルを管理する場合は、別個に管理用のワークエリアが必要です。この個数に限りがあるため、特にテキストバッファのブロックが小さい場合（ＥＭＳ上にある場合）には、１６ＭＢ全てを使えない場合があります。


■ ＥＭＳ／ＸＭＳの解放
-----------------------------
　ＤＯＳコマンドを実行する際に、未使用のＥＭＳ／ＸＭＳメモリを解放します。これによって、ＶＺに全てのＥＭＳ／ＸＭＳメモリを割り当ておいても、メモリを有効に使えます。

★注意★

　EMM386.EXE以外のメモリマネージャには、ＸＭＳの再アロケーションが正常に動作しないものがあります。「-XM」指定でなんらかの不具合を生じた場合は、「-XM0」でＥＭＳのみ利用してください。
　さらにＭｅｌｗａｒｅでは、ＥＭＳを利用して常駐後、別のソフトがＥＭＳを取得すると、ＥＭＳの再アロケーションが正常に動作しないようです。この場合は、「-RM1」でＥＭＳの再アロケーションを禁止してください。




		-----------------------------------------
			３．ファイルの操作
		-----------------------------------------

		◎ビューモードの強化
		◎ログファイルの管理
		◎プロファイル機能の強化
		・カレントディレクトリの保存
		・改行コードが0Ahのみのテキスト
		・64KBを越えるテキストのパス名変更
		・サイズ０のファイルへのアペンド
		・「file -$」でファイルの最後へジャンプ

　◎の機能については、マニュアルのそれぞれの説明をお読みください。


■ カレントディレクトリの保存
-----------------------------
　VZDEFディレクトリにセーブするeditfileに、編集時のカレントディレクトリを出力します。
	 -MP1 -QT5
	>a:\vz\159g
	vz159g.doc ->8FF -+0 -KY20

　これにより、「vz @@」、あるいは「vz @」でカレントディレクトリにeditfileが存在しない場合は、VZDEFのeditfileを参照し、編集時のディレクトリへ自動的に chdir 後、ファイルを開くことができます。

■ 改行コードが0Ahのみのテキスト
-----------------------------
　改行コードが0Ahのみの６４ＫＢ以上のテキストを読み込むと、３２ＫＢの境界付近の行末の１文字が欠ける不具合がありましたが、これを修正しました。


■ 64KBを越えるファイルのパス名変更
-----------------------------
　６４ＫＢ以上のファイルで、ファイルの先頭部以外を表示している時にも、パス名を変更することができます。


■ サイズ０のファイルへのアペンド
-----------------------------
　従来、サイズ０のファイルへアペンドしようとすると、「ディスクが一杯です」というエラーが表示されてアペンドできませんでしたが、これを修正しました。

■ 「file -$」でファイルの最後へジャンプ
-----------------------------
　従来版で「file -$」とすると、ファイルの最後にジャンプしました。ただしこれは仕様外のもので、ファイルのサイズが大きいと正常に動作しません。これを正式に対応しました。




		-----------------------------------------
			４．スクリーンエディット
		-----------------------------------------

		◎タイトルサーチの強化
		◎検索ウインドウでの検索オプション設定機能
		◎検索オプション指定文字
		◎ステータスラインのシステム情報を充実
		・桁対応上書きモード
		・文字列窓のキャンセル
		・^Lが効かない場合
		・矩形ブロック処理の強化
		・異常なテンポラリエラー


■ 桁対応上書きモード
-----------------------------
　桁対応上書きモードに対応しました。ただし、９８の２バイト半角文字には対応していません。
　桁対応上書きモードのマクロとの関連については、MAC16.DOCをお読みください。


■ 文字列窓のキャンセル
-----------------------------
　文字列窓で[ESC]でキャンセルした時、従来は［Ｐ］モードに戻ってしまいましたが、モードは変更しないようにしました。


■ ^Lが効かない場合
-----------------------------
　テキストのオフセットが8000hの境界をまたぐブロックが、[CTRL]+[L]で文字列取得できませんでした。


■ 矩形ブロック処理の強化
-----------------------------
　矩形ブロックモードのチェックを「mb&4」で行なうように変更し、矩形ブロック記憶後に他のブロック操作を行なっても、矩形ブロックは保存されるようになりました。


■ 異常なテンポラリエラー
-----------------------------
　テキストを１文字ずつ増やしていくと、サイズが「0FFFFh」に達した時点で「テンポラリファイルエラー」が発生する場合がありました。




		-----------------------------------------
			５．ファイラー
		-----------------------------------------

		◎ファイル属性によるカラー表示
		◎Maskメニューの拡張
		◎Delete/Rename/Attributeの内部コマンド
		◎ファイラー上で新規ファイルの作成
		◎ZCOPYとの連携
		・ファイラー動作指定オプション「FM」
		・コマンドメニューオプションの強化
		・オプション「FW」の指定範囲拡大
		・ＤＯＳコマンド窓
		・２つの窓からオープン
		・RetCD/ToCDの動作
		・INS/DELでAll/Cancel
		・pwを破壊
		・^@,[GRPH]+@ キーが入らない。
		・標準VZ.DEFでROLL UP/ROLL DOWN
		・Sort指定時「..\」は常に先頭に
		・int28h


■ ファイラー動作指定オプション「FM」
-----------------------------
　オプション「FM」の各bitで、ファイラーの各種動作を指定できます。

	FM	7	ファイラーの動作モード指定
			 +1	:[Space]キーでカーソルを移動
			 +2	:ファイル非選択時にもＥｘｅｃメニューを表示
			 +4	:『DOSコマンド』ウィンドウから実行
			 +8	:ディレクトリの先頭・最後を連続移動
			 +16	:カーソル位置反転、マーク「*」
			 +32	:ファイル選択時も拡張子自動実行


■ コマンドメニューオプションの強化
-----------------------------
　メニューに指定できる「%文字」のオプションを、次のように拡張しました。

	%1	：ソースディレクトリで選択した各ファイル名。カレントディレクト
		　リ以外の場合は、ディレクトリを頭に付ける。
	%2	：ターゲットディレクトリのディレクトリ名。ファイルが選択されて
		　いる場合には、そのファイル名を付ける
	%*	：ソースディレクトリで選択した全てのファイル名の並び。
	%!	：『DOSコマンド:』ウィンドウを表示せず、ただちに実行する。
	%^	：ＤＯＳコマンド終了後、ただちにファイラーへ戻ります。
	%@[n][file]：選択したファイル名を、レスポンスファイル「file」に出力。
		　[file]が省略された場合は、TMPディレクトリの「FILES.$$$」に
		　出力する。[n]指定時、選択したファイルがｎ個以下の場合は、
		　「%*」と同様にファイル名を並べる。
	%:	：ソースディレクトリのディレクトリ名。
	%G	：入力窓で文字列を取得。「%2」の後に指定された場合、２ウィンド
		　ウ表示時はスキップ。
	%F	：入力窓で文字列を取得。「%2」の後に指定された場合、ターゲット
		　ファイル選択時はスキップ。
	%\	：「\」 を補完。直前がスペースの場合はスキップ。
	%[opt]	：ディレクトリを選択している場合に、optを挿入。


■ オプション「FW」の指定範囲拡大
-----------------------------
　ディレクトリバッファと画面待避用ワークを、最大６４ＫＢまで確保可能としました。「FW2000」のように、大きな数も設定できます。


■ ＤＯＳコマンド窓
-----------------------------
　FM+4指定時は、ＤＯＳコマンドをウインドウ上で表示・実行します。ただしこの時は、エイリアスの展開、エイリアスメニュー等のコマンドラインの機能は使用できません。


■ ２つの窓からオープン
-----------------------------
　２つのディレクトリから同時にファイルをオープンできます。

■ RetCD/ToCDの動作
-----------------------------
　RetCD/ToCDをトグル動作にし、２つのディレクトリを交互に参照できるようにしました。

■ INS/DELでAll/Cancel
-----------------------------
　[INS]、[DEL]キーで All、All Cancel機能が使えます。


■ pwを破壊
-----------------------------
　ファイラーでパス・ファイル名を入力すると、ヒストリーバッファ「pw」が破壊されました。ファイラーでは「pr」を使うように変更しました。


■ [Ctrl]+[@],[GRPH]+@ キー
-----------------------------
　ファイラー上で[Ctrl]+[@],[GRPH]+@ キーが使えませんでした。


■ ROLL UP/ROLL DOWN
-----------------------------
　９８版標準VZ.DEFで、[RLUP]/[RLDN]キーによるページングを可能にしました。


■ Sort指定時「..\」は常に先頭に
-----------------------------
　Sortのモードによらず、「..\」を常に先頭に表示します。

■ int28h
-----------------------------
　ファイラーのキー入力待ちで int28h をコールするようにしました。これにより、ファイラー上からでもＶＣ-Ｔｅｒｍを起動できます。




		-----------------------------------------
			６．ＤＯＳコマンドライン
		-----------------------------------------

		・スワップモード「SW4」
		・常駐時にconsole上で #U
		・ＭＳ-ＤＯＳ６.ｘの対応


■ スワップモード「SW4」
-----------------------------
　従来、「SW3」で常駐した時、SYMDEB.EXEを起動すると、SYMDEBの管理メモリの
先頭部に、VZ.COMをロードしてしまいました。
　オプション「SW4」を指定すると、アプリケーション上のコマンドラインのフックを
抑止しますので、この不具合を解消できます。


■ 常駐時にconsole上で #U
-----------------------------
　常駐時に、コマンド実行後consoleファイル上で #U を実行しても、実行したコマンドの先頭位置へジャンプしませんでした。


■ ＭＳ-ＤＯＳ６.ｘの対応
-----------------------------
　ＭＳ-ＤＯＳ６.ｘで「SW3」常駐時に、外部コマンドを実行するバッチファイルを実行すると、メモリアロケーションエラーとなりました。
　また、「ＥＰＳＯＮ ＤＯＳ５ Ｒｅｌ.２」でも同様の現象が発生しました。




		-----------------------------------------
			７．カスタマイズ
		-----------------------------------------

　		◎ファイル名属性オプション「Ay」
		◎右マージンの表示オプション「Dr」
		◎全角スペースの表示オプション「Dj」
		◎スムーススクロール時のカラー化オプション「Dv」
		・コントロール文字の色分けオプション「Ae,CA」
		・編集テキストの表示スイッチ「td」
		・編集テキスト毎のステータスライン属性「vs,vy」
		・オプション「WL」の拡張
		・メニューメッセージの先頭の「$」を有効に


■ コントロール文字の色分けオプション「Ae,CA」
-----------------------------
　編集テキストのコントロール文字を、２色で色分けできます。２色目の属性を「Ae」で指定し、「Ac」、「Ae」どちらの属性を使うかを、「CA」の各ビットで指定します。
　
	CA	52	コントロール文字の色分け
			 +1	:コントロール文字の「^」
			 +2	:改行コード「↓」
			 +4	:TABコード「→」
			 +8	:EOFコード「←」
			 +16	:右マージン「<」
			 +32	:全角スペース「□」
			 +64	:不正なコードの先頭数値

■ 編集テキストの表示スイッチ「td」
-----------------------------
　MAC16.DOCの!Openイベントマクロで説明しています。!Openイベントの中で「td」を設定することにより、指定の拡張子のファイルについて、「D?」の設定に関らず表示行番号モードにしたり、改行を表示したりすることができます。

　	td		編集テキストの表示スイッチ
			 +1	:表示行モード
			 +2	:CR 文字を表示
			 +4	:TAB文字を表示
			 +8	:EOF文字を表示
			 +16	:右マージンを表示
			 +32	:全角スペースを表示
			 +64	:行番号を表示


■ 編集テキスト毎のステータスライン属性「vs,vy」
-----------------------------
　「td」と同様に、!Openイベントで設定することにより、指定の拡張子のファイルに、通常とは異なるステータスラインの色を付けることができます。

	vs		編集テキストのステータスラインの属性
	vy		編集テキストのファイル名の属性


■ オプション「WL」の拡張
-----------------------------
　画面の右よせ、下よせを指定可能にしました。

	WL	0	ポップアップウィンドウの表示位置を設定します。
			 1	:←よせ
			 4	:Ｈセンタリング
			 5	:→よせ
			  +2	:↑よせ
			  +8	:Ｖセンタリング
			  +10	:↓よせ


■ メニューメッセージの先頭の「$」を有効に
-----------------------------
　メニューメッセージの先頭に「$」がある場合は、特殊文字として処理します。




		-----------------------------------------
			８．その他の改良事項
		-----------------------------------------

		・ＡＴＯＫ７／８自動制御対応
		・ＮＥＣＡＩのハングアップ


■ ＡＴＯＫ７／８自動制御対応
-----------------------------
　９８版でＡＴＯＫ７／８の起動制御に対応しました。


■ ＮＥＣＡＩのハングアップ
-----------------------------
　日本語ＦＥＰのＮＥＣＡＩ使用時、変換中にハングアップする場合がありました。これは、ＮＥＣＡＩが変換処理中にコンソールにエスケープ文字を出力するためです。ＶＺが編集中にコンソール出力を受け取ると、ＥＭＳのマッピングが壊れ、誤動作していました。
　これに対応した結果、常駐時にコマンドラインで ^C を連続して押下すると、consoleの一部が消える場合がありますが、これは仕様です。



==============================================================================
				End of VZ16.DOC
==============================================================================

